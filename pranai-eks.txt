# 1. Install AWS CLI(https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html).

curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install
aws --version

# 2. Install kubectl(https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html)

curl -O https://s3.us-west-2.amazonaws.com/amazon-eks/1.34.1/2025-09-19/bin/linux/amd64/kubectl
chmod +x kubectl
mv kubectl /usr/local/bin/

# 3. Install eksctl (https://github.com/eksctl-io/eksctl)

ARCH=amd64
PLATFORM=$(uname -s)_$ARCH
curl -sLO "https://github.com/eksctl-io/eksctl/releases/latest/download/eksctl_$PLATFORM.tar.gz"
# (Optional) Verify checksum
curl -sL "https://github.com/eksctl-io/eksctl/releases/latest/download/eksctl_checksums.txt" | grep $PLATFORM | sha256sum --check
tar -xzf eksctl_$PLATFORM.tar.gz -C /tmp && rm eksctl_$PLATFORM.tar.gz
sudo install -m 0755 /tmp/eksctl /usr/local/bin && rm /tmp/eksctl

# 4. Install EKS Cluster

# Create EKS Cluster, once this is executed then we can see it in EKS section.
eksctl create cluster --name=EKS-1 --region=ap-south-1 --zones=ap-south-1a,ap-south-1b --without-nodegroup

# Now attach the IAM role to the EKS Cluster.
eksctl utils associate-iam-oidc-provider --region ap-south-1 --cluster EKS-1 --approve

# Create the Node Group, for worker nodes will be created in ec2. But what about master, master will be mainatined by EKS only.
eksctl create nodegroup --cluster=EKS-1 --region=ap-south-1 --name=node2 --node-type=c7i-flex.large --nodes=3 --nodes-min=2 --nodes-max=4 --node-volume-size=20 --ssh-access --ssh-public-key=jyothikp --managed --asg-access --external-dns-access --full-ecr-access --appmesh-access --alb-ingress-access

# Update the EKS Cluster
aws eks update-kubeconfig --name EKS-1 --region=ap-south-1



